@page
@model Foodloop.Pages.Bod.AdminDashboardModel
@using Foodloop.Models

<h2>Admin Dashboard</h2>

<!-- Tilføj Bod -->
<h4>Tilføj ny bod</h4>
<form method="post" asp-page-handler="AddBod" class="mb-4">
    <input type="text" class="form-control mb-2" placeholder="Navn" asp-for="NewBod.Navn" required />
    <input type="text" class="form-control mb-2" placeholder="Kategori" asp-for="NewBod.Kategori" required />
    <input type="text" class="form-control mb-2" placeholder="Lokation" asp-for="NewBod.Lokation" />
    <input type="text" class="form-control mb-2" placeholder="Kontaktinfo" asp-for="NewBod.Kontaktinfo" />
    <input type="email" class="form-control mb-2" placeholder="Email" asp-for="NewBod.Email" />
    <input type="text" class="form-control mb-2" placeholder="LoginKode" asp-for="NewBod.LoginKode" />
    <select asp-for="NewBod.Status" class="form-select mb-2">
        <option value="Aaben">Åben</option>
        <option value="Optaget">Optaget</option>
        <option value="Lukket">Lukket</option>
    </select>
    <button type="submit" class="btn btn-success">Tilføj Bod</button>
</form>

<hr />

<!-- Liste af boder -->
<div class="list-group">
    @foreach (var bod in Model.Boder)
    {
    <div class="d-flex justify-content-between align-items-center border rounded p-3 mb-2">
        <div>
            <span style="font-size:1.2em; color:@GetStatusColor(bod.Status)">●</span>
            <strong>@bod.Navn</strong> (<small>@bod.Kategori</small>)<br />
            <small>Lokation: @bod.Lokation | Kontakt: @bod.Kontaktinfo | Email: @bod.Email</small>
        </div>

        <div class="d-flex gap-2">
            <!-- Ændre status -->
            <form method="post" asp-page-handler="ChangeStatus" class="d-inline">
                <input type="hidden" asp-for="BodId" value="@bod.BodId" />
                <select asp-for="NewStatus" class="form-select form-select-sm">
                    <option value="Aaben" selected="@(bod.Status == BodStatus.Aaben ? "selected" : "")">Åben</option>
                    <option value="Optaget" selected="@(bod.Status == BodStatus.Optaget ? "selected" : "")">Optaget</option>
                    <option value="Lukket" selected="@(bod.Status == BodStatus.Lukket ? "selected" : "")">Lukket</option>
                </select>
                <button type="submit" class="btn btn-primary btn-sm">Opdater</button>
            </form>


            <!-- Opdater Bod -->
            <form method="post" asp-page-handler="UpdateBod" class="d-inline">
                <input type="hidden" asp-for="BodId" value="@bod.BodId" />
                <input type="text" name="NewBod.Navn" value="@bod.Navn" class="form-control form-control-sm mb-1" />
                <input type="text" name="NewBod.Kategori" value="@bod.Kategori" class="form-control form-control-sm mb-1" />
                <input type="text" name="NewBod.Lokation" value="@bod.Lokation" class="form-control form-control-sm mb-1" />
                <input type="text" name="NewBod.Kontaktinfo" value="@bod.Kontaktinfo" class="form-control form-control-sm mb-1" />
                <input type="email" name="NewBod.Email" value="@bod.Email" class="form-control form-control-sm mb-1" />
                <input type="text" name="NewBod.LoginKode" value="@bod.LoginKode" class="form-control form-control-sm mb-1" />
                <select name="NewBod.Status" class="form-select form-select-sm mb-1">
                    <option value="Aaben" selected="@(bod.Status == BodStatus.Aaben ? "selected" : "")">Åben</option>
                    <option value="Optaget" selected="@(bod.Status == BodStatus.Optaget ? "selected" : "")">Optaget</option>
                    <option value="Lukket" selected="@(bod.Status == BodStatus.Lukket ? "selected" : "")">Lukket</option>
                </select>
                <button type="submit" class="btn btn-warning btn-sm">Opdater Bod</button>
            </form>


            <!-- Slet bod -->
            <form method="post" asp-page-handler="DeleteBod" class="d-inline">
                <input type="hidden" name="BodId" value="@bod.BodId" />
                <button type="submit" class="btn btn-danger btn-sm">Slet</button>
            </form>
        </div>
    </div>
    }
</div> 

@functions {
private string GetStatusColor(BodStatus status)
{
return status switch
{
BodStatus.Aaben => "green",
BodStatus.Optaget => "goldenrod",
BodStatus.Lukket => "red",
_ => "gray"
};
}
}
